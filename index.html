<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <canvas id="map" width="100" height="100"></canvas>
    <button onclick="startGame()">StartGame</button>
    <button onclick="stopGame()">StopGame</button>
    <script src="dist/EventConstructor.js"></script>
    <script src="dist/BoardManager.js"></script>
    <script src="dist/Entity.js"></script>
    <script src="dist/Game.js"></script>
    <script src="dist/player.js"></script>
    <script>

        let ctx = document.querySelector('#map');
   
        // const game = new Game(ctx)

        // let basket = {
        //     Apple
        // }
        // game.addBasket(basket);

        // game.spawnApples((i, j, appleSpawn, rand) =>{

        //     let num1 = Math.random();
        //     let spawn = num1 < appleSpawn;

        //     if(rand < .1 && spawn)
        //         game.generateFruit("Apple", i ,j);
        // });

        // const snake = new Snake();
        // game.Player = snake;

        // game.keyboardMonitor(code => {
        //     snake.changeDirection(code);
        // });

        // function recurse(){

        //     game.drawBoard();
        //     game.filterApples();

        //     snake.newPosition();

        //     game.Player = snake;
            
        //     if(game.isEndGame()) {
        //         alert("END GAME");
        //         return;
        //     }

        //     setTimeout(()=>{
        //         recurse();
        //     }, game.Settings.speed);
        // }

        // recurse();

        const ev = document.createEvent('Event');
        ev.initEvent("stopGame", true,true);

        const game = new Game(ctx);
        game.addEntity(player);

        function stopGame(){
            document.dispatchEvent(ev);
        }

        function startGame(){

            game.drawBoard();

            let newGame = setTimeout(startGame, 10);

            document.addEventListener("stopGame",()=>{
                clearTimeout(newGame);
            })
        }
        
    </script>
</body>
</html>